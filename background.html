<html>
  <script src="json2.js"></script>
  <script>
    var songData = null;
    chrome.extension.onRequest.addListener(
      function(request, sender, sendResponse) {
        if (request.message_type == "debug") {
          DebugMessage(request.debug_message);
        }
        else if (request.message_type == "song") {
          songData = JSON.parse(request.song_data);
          var notification = webkitNotifications.createHTMLNotification("notification.html");
          notification.show();
        }
      }
    );

    function get_song_data() {
      return songData;
    }
    function song_notification(song, artist) {
      var notification = webkitNotifications.createNotification(
        "icon48.gif",
        "",
        song + "-" + artist
      );
      notification.show();
    }

    function DebugMessage(message) {
      var notification = webkitNotifications.createNotification(
        "icon48.gif",
        "DEBUG",
        "PandoraPlus: " + message
      );
      notification.show();
    }
  </script>
